--// SERVICES
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local LocalPlayer = Players.LocalPlayer
local Camera = workspace.CurrentCamera
local PlayerGui = LocalPlayer:WaitForChild("PlayerGui")

--// ESP VARS
local ESPEnabled = false
local ESP_CACHE = {}

--// STATS VARS
local StatsVisible = false
local FPS = 0

--// SILENT AIM VARS
local SilentAimEnabled = false

--// GUI TOGGLE VAR
local GUIVisible = true

--// ================= UI =================

local ScreenGui = Instance.new("ScreenGui", PlayerGui)
ScreenGui.Name = "DylanGUI"
ScreenGui.ResetOnSpawn = false

local Main = Instance.new("Frame", ScreenGui)
Main.Size = UDim2.fromScale(0.35, 0.4) -- smaller UI
Main.Position = UDim2.fromScale(0.325, 0.3)
Main.BorderSizePixel = 0
Main.Active = true
Main.Draggable = true

local Gradient = Instance.new("UIGradient", Main)
Gradient.Color = ColorSequence.new{
	ColorSequenceKeypoint.new(0, Color3.fromRGB(0,0,0)),  -- black
	ColorSequenceKeypoint.new(1, Color3.fromRGB(255,255,255)) -- white
}
Instance.new("UICorner", Main).CornerRadius = UDim.new(0,14)

-- Sidebar
local Sidebar = Instance.new("Frame", Main)
Sidebar.Size = UDim2.fromScale(0.25,1)
Sidebar.BackgroundColor3 = Color3.fromRGB(20,20,20)
Sidebar.BorderSizePixel = 0
Instance.new("UICorner", Sidebar).CornerRadius = UDim.new(0,14)

local Title = Instance.new("TextLabel", Sidebar)
Title.Size = UDim2.fromScale(1,0.18)
Title.BackgroundTransparency = 1
Title.Text = "ðŸ”¥ DYLAN GUI"
Title.TextColor3 = Color3.fromRGB(255,255,255)
Title.Font = Enum.Font.GothamBold
Title.TextScaled = true

local function MakeButton(text,y)
	local b = Instance.new("TextButton", Sidebar)
	b.Size = UDim2.fromScale(0.85,0.12)
	b.Position = UDim2.fromScale(0.075,y)
	b.BackgroundColor3 = Color3.fromRGB(35,35,35)
	b.Text = text
	b.TextColor3 = Color3.fromRGB(255,255,255)
	b.Font = Enum.Font.GothamSemibold
	b.TextScaled = true
	b.BorderSizePixel = 0
	Instance.new("UICorner", b).CornerRadius = UDim.new(0,12)
	return b
end

local ESPBtn = MakeButton("ESP",0.25)
local AimBtn = MakeButton("Silent Aim",0.42)
local StatsBtn = MakeButton("Stats",0.59)

-- Content
local Content = Instance.new("Frame", Main)
Content.Size = UDim2.fromScale(0.75,1)
Content.Position = UDim2.fromScale(0.25,0)
Content.BackgroundTransparency = 1

local ContentText = Instance.new("TextLabel", Content)
ContentText.Size = UDim2.fromScale(1,0.3)
ContentText.BackgroundTransparency = 1
ContentText.Text = "Select a tab ðŸ‘€"
ContentText.Font = Enum.Font.GothamBold
ContentText.TextScaled = true
ContentText.TextColor3 = Color3.fromRGB(255,255,255)

-- ESP Toggle
local ESPToggle = Instance.new("TextButton", Content)
ESPToggle.Size = UDim2.fromScale(0.4,0.12)
ESPToggle.Position = UDim2.fromScale(0.3,0.35)
ESPToggle.BackgroundColor3 = Color3.fromRGB(30,30,30)
ESPToggle.Text = "ESP : OFF"
ESPToggle.TextColor3 = Color3.fromRGB(255,255,255)
ESPToggle.Font = Enum.Font.GothamBold
ESPToggle.TextScaled = true
ESPToggle.Visible = false
ESPToggle.BorderSizePixel = 0
Instance.new("UICorner", ESPToggle).CornerRadius = UDim.new(0,14)

-- Silent Aim Toggle
local AimToggle = Instance.new("TextButton", Content)
AimToggle.Size = UDim2.fromScale(0.4,0.12)
AimToggle.Position = UDim2.fromScale(0.3,0.35)
AimToggle.BackgroundColor3 = Color3.fromRGB(30,30,30)
AimToggle.Text = "Silent Aim : OFF"
AimToggle.TextColor3 = Color3.fromRGB(255,255,255)
AimToggle.Font = Enum.Font.GothamBold
AimToggle.TextScaled = true
AimToggle.Visible = false
AimToggle.BorderSizePixel = 0
Instance.new("UICorner", AimToggle).CornerRadius = UDim.new(0,14)

-- Stats Label
local StatsLabel = Instance.new("TextLabel", Content)
StatsLabel.Size = UDim2.fromScale(1,0.3)
StatsLabel.Position = UDim2.fromScale(0,0.35)
StatsLabel.BackgroundTransparency = 1
StatsLabel.Font = Enum.Font.GothamBold
StatsLabel.TextScaled = true
StatsLabel.TextColor3 = Color3.fromRGB(255,255,255)
StatsLabel.Visible = false

-- Tab Logic
ESPBtn.MouseButton1Click:Connect(function()
	ContentText.Text = "ESP SETTINGS"
	ESPToggle.Visible = true
	AimToggle.Visible = false
	StatsLabel.Visible = false
	StatsVisible = false
end)

AimBtn.MouseButton1Click:Connect(function()
	ContentText.Text = "SILENT AIM"
	ESPToggle.Visible = false
	AimToggle.Visible = true
	StatsLabel.Visible = false
	StatsVisible = false
end)

StatsBtn.MouseButton1Click:Connect(function()
	ContentText.Text = "PLAYER STATS"
	ESPToggle.Visible = false
	AimToggle.Visible = false
	StatsLabel.Visible = true
	StatsVisible = true
end)

--// ================= SILENT AIM LOADSTRING =================
AimToggle.MouseButton1Click:Connect(function()
	SilentAimEnabled = not SilentAimEnabled
	AimToggle.Text = SilentAimEnabled and "Silent Aim : ON" or "Silent Aim : OFF"
	if SilentAimEnabled then
		pcall(function()
			loadstring(game:HttpGet('https://raw.githubusercontent.com/dylanvalx/universal-slient-aim/refs/heads/main/slient%20aim'))()
		end)
	end
end)

--// ================= GUI KEYBIND =================
UserInputService.InputBegan:Connect(function(input, processed)
	if processed then return end
	if input.KeyCode == Enum.KeyCode.P then
		GUIVisible = not GUIVisible
		Main.Visible = GUIVisible
	end
end)
